# I-LIT Book Content Format

## Source

Book content is served from CloudFront CDN as JavaScript files:

```
https://d3etodn1cqduev.cloudfront.net/content/ilit/basecontent/library/{book_id}/{book_id}.js
```

These are **publicly accessible** (no auth required), unlike cover images which require CloudFront signed cookies.

Book metadata (title, author, lexile, genre, description) comes from:
```
https://d3etodn1cqduev.cloudfront.net/content/ilit/ilit45ica/curriculum/g4/g4_library.js
```

Cover images require auth:
```
https://d3etodn1cqduev.cloudfront.net/content/ilit/ilit45ica/curriculum/g4/media/{book_id}_cover_image.jpeg
```

## Content Format

Each book JS file defines `var content = {...}` with this structure:

```typescript
{
  Styles: string[];           // CSS filenames (not needed)
  CoverImage: {
    media_info: {
      src: string;            // e.g. "{book_id}/media/cover.jpg"
      height: number;
      width: number;
      id: "cover_image";
    }
  };
  Toc: Record<string, {       // Table of Contents
    title: string;             // Chapter title
    order: number;             // Sort order (0-based)
    playOrder: string;         // Play order (1-based)
    idref: string;             // Chapter ID (e.g., "c01", "c02")
    href: string;              // Original HTML filename
    linear: "yes";
    visibility: 1;
    parentPlayOrder: 0;
  }>;
  Pages: Record<string, {     // Page content keyed by chapter ID
    id: number;
    sentences: Array<{
      sentence_text: string;   // HTML content with word-level spans
      content_type: "text" | "image";
      sentence_length: number;
      media_info: string | { src: string; height: number; width: number; id: string };
      related: number;
      id: string;              // e.g., "5_1", "5_2" (page_sentence)
    }>;
  }>;
}
```

## Word-Level Markup

Each sentence uses `<z class="w">` tags to wrap individual words for interactive features (click-to-define, text-to-speech word highlighting):

```html
<p class='indent'>
  <z class='s'>
    <z class="w">The</z> <z class="w">show</z> <z class="w">began</z>...
  </z>
</p>
```

- `<z class="s">` wraps a sentence
- `<z class="w">` wraps a word
- Standard HTML entities: `&#x201C;` (left quote), `&#x201D;` (right quote), `&#x2019;` (apostrophe)
- Paragraph classes: `indent`, `noindent`, `center`
- Chapter headings use `<h1 class='chapter'>` with `<span class="big">` and `<span class="small">`

## ToC Entry Types

Standard chapter IDs in the ToC:
- `cover` — Cover page
- `tp` — Title page
- `crt` — Copyright page
- `toc` — Table of contents
- `c01`, `c02`, ... `c10` — Content chapters
- Some books also have: `ded` (dedication), `epi` (epilogue), `aft` (afterword)

## Current Inventory

26 books downloaded to `content/books/raw/`, spanning 100L to 1030L:

| Lexile | Title | Author | Words | Chapters |
|--------|-------|--------|-------|----------|
| 100L | Body Switch | Saddleback | 5,223 | 13 |
| 130L | Hero of Crows Crossing | Saddleback | 5,276 | 13 |
| 150L | Ghost Mountain | Saddleback | 5,230 | 13 |
| 290L | Dream of the Dead | Marie Seth | 9,329 | 8 |
| 350L | Adventures of Tom Sawyer | Mark Twain | 15,494 | 15 |
| 370L | The Jungle Book | Rudyard Kipling | 33,121 | 37 |
| 440L | Crash Dive | Lee Frederick | 7,986 | 10 |
| 530L | Adventures of Sherlock Holmes | Conan Doyle | 19,981 | 9 |
| 530L | Little Big Top | Doris Hiller | 9,457 | 10 |
| 580L | David Copperfield | Charles Dickens | 17,449 | 14 |
| 590L | Three Musketeers | Alexandre Dumas | 11,832 | 12 |
| 650L | Alamo Wars | Ray Villareal | 45,105 | 39 |
| 740L | Last Book in the Universe | Rodman Philbrick | 47,879 | 41 |
| 760L | Virtual War | Gloria Skurzynski | 39,250 | 17 |
| 790L | Ask Me No Questions | Marina Budhos | 37,663 | 22 |
| 810L | Heidi | Johanna Spyri | 91,757 | 26 |
| 820L | A Christmas Carol | Charles Dickens | 26,275 | 9 |
| 850L | Other Side of the Sky | Farah Ahmedi | 70,651 | 24 |
| 870L | Sherlock Holmes (full) | Conan Doyle | 44,337 | 15 |
| 890L | Treasure Island | Robert Louis Stevenson | 70,530 | 43 |
| 950L | The Secret Garden | Frances H. Burnett | 80,709 | 29 |
| 950L | Tom Sawyer (full) | Mark Twain | 71,093 | 39 |
| 960L | Huckleberry Finn | Mark Twain | 110,962 | 46 |
| 1020L | Black Beauty | Anna Sewell | 60,135 | 51 |
| 1030L | Frederick Douglass | Frederick Douglass | 40,685 | 17 |
| 1030L | Wizard of Oz | Frank Baum | 39,729 | 27 |

## Catalog JSON

Processed metadata is in `content/books/catalog.json`. The build script is `scripts/build-catalog.mjs`.

## Missing: Cover Images

Cover images are behind CloudFront auth. Options:
1. Download manually via browser (user offered to do this)
2. Use placeholder covers generated by AI
3. Extract from the book content files (some have embedded cover image references)

## Integration TODO

- [ ] Convert raw JS to our Book type format (strip `<z>` tags, split into pages)
- [ ] Generate or obtain cover images
- [ ] Update library page to use real catalog instead of placeholder BOOK_IDS
- [ ] Update reader to handle real book content structure
